import { Response, Router } from "express";
import { StatusCodes } from "http-status-codes";

const {{name}}Router = new Router();

{{#each endpoints as |endpoint|}}
{{#addFunctionAndInterfaceNames ../name endpoint}}

import { {{#if handler.validation.class}}{{handler.validation.class}}{{else}}{{handler.validation.function}}{{/if}} } from '{{handler.validation.path}}';
import { {{#if handler.request.class}}{{handler.request.class}}{{else}}{{handler.request.function}}{{/if}} } from '{{handler.request.path}}';

{{#if param}}
export type {{interfaceName}}RequestParams {
  {{param}}: string;
}
{{/if}}

{{#if body}}
export interface {{interfaceName}}RequestBody {
  {{#each body}}
  {{this.name}}: {{this.type}};
  {{/each}}
}
{{/if}}

export interface {{interfaceName}}HandlerResponse {
  statusCode: StatusCodes;
  {{#each response}}
  {{this.name}}: {{this.type}};
  {{/each}}
}

export interface {{interfaceName}}Request {
  {{#if param}}params: {{interfaceName}}RequestParams; {{/if}}
  {{#if body}}body: {{interfaceName}}RequestBody; {{/if}}
}

{{name}}Router.{{method}}("/{{eName}}{{#if param}}/:{{param}}{{/if}}", 
  async (
    req: {{interfaceName}}Request, 
    res: Response
  ) => {
    {{#if param}}const param: string = req.params.{{param}};{{/if}}
    {{#if body}}const body: {{interfaceName}}RequestBody = req.body;{{/if}}
    {{#if handler.validation.class}}
    {{handler.validation.class}}.{{handler.validation.function}}(param, body);
    {{else}}
    {{handler.validation.function}}.{{handler.validation.function}}(param, body);
    {{/if}}
    {{#if handler.request.class}}
    return {{handler.request.class}}.{{handler.request.function}}(param, body);
    {{else}}
    return {{handler.request.function}}.{{handler.request.function}}(param, body);
    {{/if}}
});


{{/addFunctionAndInterfaceNames}}
{{/each}}